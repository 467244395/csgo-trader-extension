version: 0.2

phases:
  install:
    runtime-versions:
      nodejs: 12
  pre_build:
    commands:
      - cd extension
  build:
    commands:
      - mkdir build
      - cd chrome
      - zip -r ../build/chrome.zip .
      - cd ..
      - cp ./firefox/manifest.json ./chrome/manifest.json
      - cd firefox
      - zip -r ../build/firefox.zip .
  post_build:
    commands:
      - aws s3 sync ./build $BUCKET/extension/latest